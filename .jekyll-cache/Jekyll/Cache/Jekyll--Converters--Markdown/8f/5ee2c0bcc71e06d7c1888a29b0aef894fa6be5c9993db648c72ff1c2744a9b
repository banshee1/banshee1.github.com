I"Ùw<h1 id="æ³°å¦å°¼å…‹å·ç”Ÿå­˜è€…é¢„æµ‹ä½œä¸šæ–‡æ¡£">æ³°å¦å°¼å…‹å·ç”Ÿå­˜è€…é¢„æµ‹ä½œä¸šæ–‡æ¡£</h1>

<p>1511415		æ¨Šæ–‡æ°	è½¯ä»¶å·¥ç¨‹</p>

<h3 id="1-ä»»åŠ¡æè¿°">1.	ä»»åŠ¡æè¿°</h3>

<p>â€‹            åœ¨kaggleçš„ç½‘ç«™ä¸Šå¯ä»¥ä¸‹è½½è®­ç»ƒæ•°æ®train.csvå’Œæµ‹è¯•æ•°æ®test.csvï¼Œåˆ©ç”¨train.csvä¸­çš„ä¹˜å®¢æ•°æ®æ¥è®­ç»ƒè‡ªå·±çš„æ¨¡å‹ï¼Œç„¶åé¢„æµ‹test.csvä¸­ä¹˜å®¢çš„ç”Ÿå­˜æƒ…å†µã€‚</p>

<hr />

<h3 id="2-å®éªŒç¯å¢ƒ">2.	å®éªŒç¯å¢ƒ</h3>

<ul>
  <li>
    <p>è¯­è¨€: 	Python3.6</p>
  </li>
  <li>
    <p>ä¸»è¦ä½¿ç”¨çš„åŒ…:      pandas, numpy, tensorflow,sklearn</p>
  </li>
</ul>

<hr />

<h3 id="3-æ•°æ®åˆ†æ">3.	æ•°æ®åˆ†æ</h3>

<ul>
  <li>
    <p><strong>Survived</strong>ï¼šæ˜¯å¦å­˜æ´»ï¼ˆ0ä»£è¡¨å¦ï¼Œ1ä»£è¡¨æ˜¯ï¼‰</p>
  </li>
  <li>
    <p><strong>Pclass</strong>ï¼šç¤¾ä¼šé˜¶çº§ï¼ˆ1ä»£è¡¨ä¸Šå±‚é˜¶çº§ï¼Œ2ä»£è¡¨ä¸­å±‚é˜¶çº§ï¼Œ3ä»£è¡¨åº•å±‚é˜¶çº§ï¼‰</p>
  </li>
  <li>
    <p><strong>Name</strong>ï¼šèˆ¹ä¸Šä¹˜å®¢çš„åå­—</p>
  </li>
  <li>
    <p><strong>Sex</strong>ï¼šèˆ¹ä¸Šä¹˜å®¢çš„æ€§åˆ«</p>
  </li>
  <li>
    <p><strong>Age</strong>:  èˆ¹ä¸Šä¹˜å®¢çš„å¹´é¾„ï¼ˆå¯èƒ½å­˜åœ¨ <code class="highlighter-rouge">NaN</code>ï¼‰</p>
  </li>
  <li>
    <p><strong>SibSp</strong>ï¼šä¹˜å®¢åœ¨èˆ¹ä¸Šçš„å…„å¼Ÿå§å¦¹å’Œé…å¶çš„æ•°é‡</p>
  </li>
  <li>
    <p><strong>Parch</strong>ï¼šä¹˜å®¢åœ¨èˆ¹ä¸Šçš„çˆ¶æ¯ä»¥åŠå°å­©çš„æ•°é‡</p>
  </li>
  <li>
    <p><strong>Ticket</strong>ï¼šä¹˜å®¢èˆ¹ç¥¨çš„ç¼–å·</p>
  </li>
  <li>
    <p><strong>Fare</strong>ï¼šä¹˜å®¢ä¸ºèˆ¹ç¥¨æ”¯ä»˜çš„è´¹ç”¨</p>
  </li>
  <li>
    <p><strong>Cabin</strong>ï¼šä¹˜å®¢æ‰€åœ¨èˆ¹èˆ±çš„ç¼–å·ï¼ˆå¯èƒ½å­˜åœ¨ <code class="highlighter-rouge">NaN</code>ï¼‰</p>
  </li>
  <li>
    <p><strong>Embarked</strong>ï¼šä¹˜å®¢ä¸Šèˆ¹çš„æ¸¯å£ï¼ˆC ä»£è¡¨ä» Cherbourg ç™»èˆ¹ï¼ŒQ ä»£è¡¨ä» Queenstown ç™»èˆ¹ï¼ŒS ä»£è¡¨ä» Southampton ç™»èˆ¹ï¼‰</p>

    <p>â€‹	ä»¥ä¸Šå³ä¸ºtrain.csvä¸­æ‰€åŒ…å«çš„æ•°æ®ï¼Œå…¶ä¸­å¯ä»¥çœ‹å‡ºå­˜åœ¨éƒ¨åˆ†åˆ—æ˜¯æ— æ³•ç›´æ¥ç”¨äºè®¡ç®—çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹åŸå§‹çš„æ•°æ®è¿›è¡ŒåŠ å·¥ã€‚åˆ©ç”¨pandas.read_csvè¯»å–æ•°æ®å¹¶è¿›è¡Œç»Ÿè®¡:</p>

    <p>â€‹</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
  
<span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'train.csv'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">train_data</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</code></pre></div>    </div>

    <p>â€‹</p>

    <p>â€‹	ç„¶åå°±ä¼šå¾—åˆ°ä»¥ä¸‹ç»“æœ:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RangeIndex: 891 entries, 0 to 890
Data columns (total 12 columns):
PassengerId    891 non-null int64
Survived       891 non-null int64
Pclass         891 non-null int64
Name           891 non-null object
Sex            891 non-null object
Age            714 non-null float64
SibSp          891 non-null int64
Parch          891 non-null int64
Ticket         891 non-null object
Fare           891 non-null float64
Cabin          204 non-null object
Embarked       889 non-null object
dtypes: float64(2), int64(5), object(5)
memory usage: 83.6+ KB
None
</code></pre></div>    </div>

    <p>â€‹	æ•°æ®çš„Cabinåˆ—ç¼ºå¤±è¿‡äºä¸¥é‡ï¼Œæ‰€ä»¥åœ¨è®­ç»ƒæ¨¡å‹æ—¶é€‰æ‹©èˆæ‰è¿™ä¸€åˆ—ã€‚è€Œå¯¹äºAgeåˆ—ï¼Œè§ä¸‹å›¾ï¼š</p>
  </li>
</ul>

<p><img src="C:\Users\banshee\Desktop\ML\v2-23facc53c6559952e0137e809656831f_r.jpg" width="450px" height="400px" /></p>

<p>â€‹	 						å›¾1:  æ€§åˆ«å¯¹ç”Ÿå­˜ç»“æœå½±å“çš„ç»Ÿè®¡å›¾</p>

<p>â€‹		ç”±æ•°æ®çš„ç»Ÿè®¡å›¾æ¥çœ‹ï¼ŒAgeåˆ—å¯¹ç”Ÿå­˜ç»“æœçš„å½±å“æ˜¯ä¸èƒ½å¿½ç•¥çš„ï¼Œä½†æ˜¯ç”±äºç¼ºå¤±é‡ä¹Ÿä¸åœ¨å°‘æ•°ï¼Œæ‰€ä»¥ç®€å•çš„ç”¨å¹³å‡å¹´é¾„å¡«å……ç©ºç¼ºå€¼å¯èƒ½å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„è§£å†³åŠæ³•ã€‚æœ€åé€‰æ‹©åˆ©ç”¨éšæœºæ£®æ—ç®—æ³•æ¥è¡¥å…¨å¹´é¾„çš„ç©ºç¼ºå€¼.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">age</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[[</span><span class="s">'Age'</span><span class="p">,</span><span class="s">'Survived'</span><span class="p">,</span><span class="s">'Fare'</span><span class="p">,</span><span class="s">'Parch'</span><span class="p">,</span><span class="s">'SibSp'</span><span class="p">,</span><span class="s">'Pclass'</span><span class="p">]]</span>
<span class="n">age_notnull</span> <span class="o">=</span> <span class="n">age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dataset</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">notnull</span><span class="p">())]</span>
<span class="n">age_isnull</span> <span class="o">=</span> <span class="n">age</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dataset</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">isnull</span><span class="p">())]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">age_notnull</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">age_notnull</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">rfr</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rfr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="n">predictAges</span> <span class="o">=</span> <span class="n">rfr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">age_isnull</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:])</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dataset</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">isnull</span><span class="p">()),</span><span class="s">'Age'</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictAges</span>
</code></pre></div></div>

<p>â€‹		å…¶ä»–åˆ—çš„ç©ºç¼ºé€‰æ‹©ç”¨ä¼—æ•°æˆ–è€…å¹³å‡æ•°å¡«å……ã€‚</p>

<hr />

<h3 id="4-ç®—æ³•é€‰æ‹©å’Œç‰¹å¾å¤„ç†">4.	ç®—æ³•é€‰æ‹©å’Œç‰¹å¾å¤„ç†</h3>

<h4 id="41--ç®—æ³•é€‰æ‹©">4.1  ç®—æ³•é€‰æ‹©</h4>

<p>â€‹		åœ¨é€‰æ‹©å®ç°ç®—æ³•æ—¶ï¼Œæˆ‘ä¸»è¦è€ƒè™‘è¿‡<strong>éšæœºæ£®æ—</strong>å’Œ<strong>ç¥ç»ç½‘ç»œ</strong>ã€‚ç»è¿‡åˆæ­¥çš„å¯¹æ¯”å®éªŒï¼Œæˆ‘è®¤ä¸ºç¥ç»ç½‘ç»œçš„å¯è°ƒ</p>

<p>â€‹	èŠ‚ç©ºé—´æ›´å¤§è€Œä¸”åˆæ­¥æ•ˆæœæ¯”è¾ƒå¥½ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©äº†ç”¨tensorflowæ­å»ºä¸€ä¸ªç®€å•çš„networkã€‚æ¨¡å‹å›¾å¦‚ä¸‹:</p>

<p><img src="C:\Users\banshee\Desktop\ML\model.png" width="400px" height="300px" /></p>

<p>â€‹		ç”±äºæ•°æ®å¤æ‚åº¦å¹¶ä¸é«˜ï¼Œæ‰€ä»¥é‡‡ç”¨åŒå±‚å³å¯ã€‚</p>

<h4 id="42-ç‰¹å¾å¤„ç†">4.2	ç‰¹å¾å¤„ç†</h4>

<p>â€‹		å¯¹äºç‰¹å¾çš„å¤„ç†ï¼Œä¸»è¦æœ‰ä¸¤ç§:</p>

<p>â€‹			(1)	è¿ç»­å€¼ä¿æŒä¸å˜ï¼Œè¡¨ç¤ºç±»å‹çš„å€¼è½¬æ¢æˆone-hot-arrayã€‚</p>

<p>â€‹			(2)	ç±»å‹å€¼ç”¨æ•´æ•°æ ‡è¯†ã€‚</p>

<p>â€‹		ä¸Šè¿°ä¸¤ç§æ–¹æ³•ï¼Œéƒ½æ˜¯å°†è®­ç»ƒæ•°æ®è½¬æ¢æˆçŸ©é˜µæ”¾å…¥åˆ°networkä¸­ã€‚å…¶ä¸­one-hot-arrayç‰ˆæœ¬å®ç°åœ¨onehot.pyä¸­ï¼Œæ•´æ•°è¡¨ç¤ºç±»åˆ«ç‰ˆæœ¬å®ç°åœ¨titanic.pyä¸­ã€‚<strong>è€Œå®éªŒç»“æœè¡¨æ˜ï¼Œone-hot-arrayå®ç°çš„ç®—æ³•æ•ˆæœè¦</strong></p>

<p><strong>ç¨ç¨åœ°å¥½äºæ˜ å°„åˆ°æ•´æ•°çš„ç®—æ³•ã€‚</strong></p>

<h5 id="421-ä»£è¡¨ç±»å‹çš„å±æ€§">4.2.1	ä»£è¡¨ç±»å‹çš„å±æ€§</h5>

<p>â€‹			åŒ…æ‹¬Pclass, Sex, Embarkedè¿™å‡ åˆ—ã€‚æŒ‰ç…§ä¸Šè¿°æ‰€è¯´ï¼Œè‹¥æ˜ å°„åˆ°æ•´æ•°ï¼Œåˆ™å®ç°å¾ˆç®€å•ã€‚</p>

<p>â€‹		è€Œåœ¨è½¬å˜ä¸ºont-hot-arrayæ—¶ï¼Œåˆ™åˆ©ç”¨sklearnä¸­å°è£…çš„å‡½æ•°æ¥å®ç°:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span><span class="p">,</span> <span class="n">OneHotEncoder</span>
<span class="n">labelencoder_X_1</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">labelencoder_X_1</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">X_train</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">labelencoder_X_1</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">X_train</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">labelencoder_X_1</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">X_train</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">labelencoder_X_1</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">])</span>

<span class="n">labelencoder_X_2</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">X_test</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">labelencoder_X_2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">X_test</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">labelencoder_X_2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">X_test</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">labelencoder_X_2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">X_test</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">labelencoder_X_2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">[:,</span> <span class="mi">6</span><span class="p">])</span>

<span class="n">onehotencoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">onehotencoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>

<span class="n">onehotencoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">onehotencoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
</code></pre></div></div>

<h4 id="422-nameå±æ€§åˆ—çš„å¤„ç†">4.2.2	Nameå±æ€§åˆ—çš„å¤„ç†</h4>

<p>â€‹			å¯¹äºåå­—è¿™ä¸€åˆ—ï¼Œæœ‰ç”¨çš„ä¿¡æ¯åªæœ‰ä¸­é—´çš„é‚£ä¸ªå¤´è¡”ã€‚è€Œç§°å·å¯¹ç”Ÿå­˜çš„å½±å“ç»Ÿè®¡å¦‚ä¸‹å›¾:</p>

<p><img src="C:\Users\banshee\Desktop\ML\v2-e45fd8a37464233e23fe526671470582_r.jpg" width="400px" height="300px" /></p>

<p>â€‹								å›¾2:		å¤´è¡”å¯¹å­˜æ´»å½±å“çš„ç»Ÿè®¡</p>

<p>â€‹			æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå¤´è¡”å¯¹äºç”Ÿå­˜æ¦‚ç‡çš„å½±å“æ˜¯å­˜åœ¨çš„ï¼Œæ‰€ä»¥æ ¹æ®å¤´è¡”å¯ä»¥æŠŠä¹˜å®¢åˆ†ä¸ºè´µå®¾å’Œæ™®é€šäººï¼Œ</p>

<p>â€‹		è€Œæ˜¾ç„¶è´µå®¾çš„å­˜æ´»æ¦‚ç‡è¦æ¯”æ™®é€šä¹˜å®¢è¦å¤§ã€‚</p>

<h4 id="423-å…¶ä»–å±æ€§çš„å¤„ç†">4.2.3	å…¶ä»–å±æ€§çš„å¤„ç†</h4>

<p>â€‹			åœ¨ä¸¤ä¸ªå®ç°çš„pyæ–‡ä»¶ä¸­ï¼Œå¯¹ä»¥ä¸‹å±æ€§è¿›è¡Œäº†ä¸åŒçš„å¤„ç†:</p>

<p>â€‹				åœ¨titanic.pyä¸­ï¼ŒSibSpå’ŒParchæ˜¯ç›´æ¥æ”¾å…¥äº†æ•°æ®ä¸­ï¼Œè€Œonhot.pyä¸­åˆ™å°†ä¸¤è€…ç›¸åŠ å¹¶æ ¹æ®å’Œå°†</p>

<p>â€‹			  ä¹˜å®¢åˆ†ä¸ºäº†4ç±»:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dataset</span><span class="p">[</span><span class="s">"FamilyS"</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">"SibSp"</span><span class="p">]</span> <span class="o">+</span> <span class="n">dataset</span><span class="p">[</span><span class="s">"Parch"</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">X_test</span><span class="p">[</span><span class="s">"FamilyS"</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">[</span><span class="s">"SibSp"</span><span class="p">]</span> <span class="o">+</span> <span class="n">X_test</span><span class="p">[</span><span class="s">"Parch"</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">family</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"Single"</span>
    <span class="k">elif</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"Couple"</span>
    <span class="k">elif</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"InterM"</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"Large"</span>
<span class="n">dataset</span><span class="p">[</span><span class="s">"FamilyS"</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">"FamilyS"</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">family</span><span class="p">)</span>
<span class="n">X_test</span><span class="p">[</span><span class="s">"FamilyS"</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">[</span><span class="s">"FamilyS"</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">family</span><span class="p">)</span>
</code></pre></div></div>

<p>â€‹				åŒæ—¶ä¹Ÿå°†å…¶ç¼–ç ä¸ºone-hot-arrayå½¢å¼ã€‚è€Œå®éªŒç»“æœæ˜¾ç¤ºä¸¤è€…ä¹‹é—´çš„å·®å¼‚å¹¶ä¸å¤§ã€‚</p>

<p>â€‹			Ticketå±æ€§å’ŒCabinå±æ€§ç”±äºéš¾ä»¥ä½“ç°ä¹˜å®¢ç‰¹å¾å’Œç¼ºå¤±è¿‡å¤šæ•…èˆå»ã€‚</p>

<p>â€‹				åŒæ—¶ï¼Œå¯¹äºyï¼ŒåŒæ ·è½¬å˜æˆone-hot-labelçš„å½¢å¼ï¼Œå³[0,1]å’Œ[1,0]ã€‚</p>

<hr />

<h3 id="5-ç®—æ³•å®ç°">5.	ç®—æ³•å®ç°</h3>

<h4 id="51-åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•æœº">5.1	åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•æœº</h4>

<p>â€‹		åˆ©ç”¨sklearnè¿›è¡Œæ•°æ®é›†çš„åˆ’åˆ†:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_train</span><span class="p">,</span><span class="n">X_val</span><span class="p">,</span><span class="n">Y_train</span><span class="p">,</span><span class="n">Y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">dataset_X</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">(),</span>
                                                 <span class="n">dataset_Y</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">(),</span>
                                                <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
                                                <span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="52-å®šä¹‰layerå‚æ•°å’Œè¾“å‡º">5.2	å®šä¹‰layerå‚æ•°å’Œè¾“å‡º</h4>

<p>â€‹		é¦–å…ˆå®šä¹‰è®­ç»ƒæ•°æ®xå’Œlabel y:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span><span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="n">name</span> <span class="o">=</span> <span class="s">'input'</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span><span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">name</span> <span class="o">=</span> <span class="s">'label'</span><span class="p">)</span>
</code></pre></div></div>

<p>â€‹		å®šä¹‰layerçš„å‚æ•°å’Œè¾“å‡º:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">weights1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">]),</span><span class="n">name</span> <span class="o">=</span> <span class="s">'weights1'</span><span class="p">)</span>
<span class="n">bias1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">7</span><span class="p">]),</span><span class="n">name</span> <span class="o">=</span> <span class="s">'bias1'</span><span class="p">)</span>
<span class="n">Wx_plus_b</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weights1</span><span class="p">)</span> <span class="o">+</span> <span class="n">bias1</span>
<span class="n">weights2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span><span class="n">name</span> <span class="o">=</span> <span class="s">'weights2'</span><span class="p">)</span>
<span class="n">bias2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">2</span><span class="p">]),</span><span class="n">name</span> <span class="o">=</span> <span class="s">'bias2'</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">output1</span><span class="p">,</span><span class="n">weights2</span><span class="p">)</span> <span class="o">+</span> <span class="n">bias2</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">keep_prob</span><span class="p">)</span>
</code></pre></div></div>

<p>â€‹		å®šä¹‰è®­ç»ƒå™¨å’Œé¢„æµ‹è¾“å‡º:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

<p>â€‹		è®­ç»ƒæ—¶ï¼Œæ€»å…±è¿›è¡Œ50æ¬¡è¿­ä»£ï¼Œæ¯5æ¬¡è¿­ä»£è¿›è¡Œä¸€æ¬¡äº¤å‰éªŒè¯:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
        <span class="n">total_loss</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">)):</span>
            <span class="n">feed_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">X_train</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span><span class="n">y</span><span class="p">:[</span><span class="n">Y_train</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">keep_prob</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">}</span>
            <span class="n">_</span><span class="p">,</span><span class="n">loss</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">train_op</span><span class="p">,</span><span class="n">cost</span><span class="p">],</span><span class="n">feed_dict</span><span class="o">=</span><span class="n">feed_dict</span><span class="p">)</span>
            <span class="n">total_loss</span> <span class="o">+=</span><span class="n">loss</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'Epoch: </span><span class="si">%4</span><span class="s">d, total loss = </span><span class="si">%.12</span><span class="s">f'</span> <span class="o">%</span> <span class="p">(</span><span class="n">epoch</span><span class="p">,</span><span class="n">total_loss</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">epoch</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">accuracy</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">acc_op</span><span class="p">,</span><span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">:</span><span class="n">X_val</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="n">Y_val</span><span class="p">,</span> <span class="n">keep_prob</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Accuracy on validation set: </span><span class="si">%.9</span><span class="s">f"</span> <span class="o">%</span> <span class="n">accuracy</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s">'training complete!'</span><span class="p">)</span>
</code></pre></div></div>

<p>â€‹		è®­ç»ƒå®Œåï¼Œtitanic.pyåœ¨äº¤å‰éªŒè¯é›†ä¸Šçš„æ­£ç¡®ç‡ä¸º 0.823ï¼Œæäº¤ç»“æœçš„æ­£ç¡®ç‡ä¸º0.779ã€‚</p>

<p>â€‹				   onehot.pyåœ¨äº¤å‰éªŒè¯é›†ä¸Šæ­£ç¡®ç‡ä¸º  0.809ï¼Œ æäº¤ç»“æœä¸º0.762</p>

<h4 id="53-æ¨¡å‹ä¼˜åŒ–">5.3	æ¨¡å‹ä¼˜åŒ–</h4>

<p>â€‹		åœ¨å®Œæˆä¸Šè¿°å‘ˆç°çš„æ¨¡å‹åï¼Œæˆ‘å‘ç°æ•ˆæœå¹¶ä¸æ˜¯é‚£ä¹ˆå¥½ã€‚è™½ç„¶åœ¨éªŒè¯é›†ä¸Šæ­£ç¡®ç‡åˆ°è¾¾äº†0.82ï¼Œä½†æ˜¯ç»“æœè¡¨</p>

<p>â€‹	     æ˜æ¨¡å‹å‡ºç°äº†è¿‡æ‹Ÿåˆçš„ç°è±¡ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåˆ™è¿›è¡Œä»¥ä¸‹å·¥ä½œ:</p>

<h5 id="531-åœ¨éšè—å±‚ä¸­è¿›è¡Œdropout">5.3.1	åœ¨éšè—å±‚ä¸­è¿›è¡Œdropout</h5>

<p>â€‹			åŠ å…¥dropoutåï¼Œæ¨¡å‹æ„å»ºæ”¹ä¸º:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>keep_prob = tf.placeholder(tf.float32)
Wx_plus_b = tf.matmul(x, weights1) + bias1
Wx_plus_b = tf.nn.dropout(Wx_plus_b, keep_prob)
</code></pre></div></div>

<h5 id="532-æ¿€æ´»å‡½æ•°å’Œæ­£åˆ™åŒ–å‚æ•°">5.3.2	æ¿€æ´»å‡½æ•°å’Œæ­£åˆ™åŒ–å‚æ•°</h5>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>output1 = tf.nn.relu(Wx_plus_b)  #åŠ å…¥æ¿€æ´»å‡½æ•°

cur_cost = tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(labels=y,logits=z))
tf.add_to_collection('losses', cur_cost)
cost = tf.add_n(tf.get_collection('losses'))    #åŠ å…¥æ­£åˆ™åŒ–å‚æ•°
</code></pre></div></div>

<p>â€‹		ç°åœ¨å†è®­ç»ƒæ¨¡å‹ï¼Œtitanic.pyåœ¨äº¤å‰éªŒè¯é›†ä¸Šæ­£ç¡®ç‡ä¸º0.810ï¼Œæäº¤åæ­£ç¡®ç‡ä¸º0.795ã€‚</p>

<p>â€‹						onhot.pyåˆ™ä¸ºåˆ«ä¸º0.810ï¼Œ0.813</p>

<p><img src="C:\Users\banshee\Desktop\ML\20180612221232.png" width="400px" height="400px" /></p>

<p>â€‹								å›¾3:		ç¨‹åºè¾“å‡ºç»“æœ</p>

<hr />

<h3 id="6-åˆ†æä¸æ€»ç»“">6.	åˆ†æä¸æ€»ç»“</h3>

<h4 id="61-è®­ç»ƒç»“æœåˆ†æ">6.1	è®­ç»ƒç»“æœåˆ†æ</h4>

<p>â€‹		åœ¨åŠ å…¥dropoutï¼Œæ¿€æ´»å‡½æ•°ä¹‹å‰ï¼Œæ¨¡å‹å‡ºç°äº†è¾ƒä¸ºä¸¥é‡çš„è¿‡æ‹Ÿåˆç°è±¡ã€‚ä½†æ˜¯åœ¨ä¼˜åŒ–æ¨¡å‹çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°</p>

<p>â€‹	     å¯¹ç»“æœçš„æå‡ååˆ†ä¸æ˜æ˜¾ï¼Œå¯èƒ½çš„åŸå› æ˜¯æ•°æ®é›†æ¯”è¾ƒç²—ç³™ï¼Œè®­ç»ƒæ•°æ®è¾ƒå°‘è€Œä¸”å™ªå£°è¾ƒå¤šï¼Œä½¿å¾—ç¥ç»ç½‘ç»œç­‰</p>

<p>â€‹	     å¯¹æ•°æ®æ¯”è¾ƒæ•æ„Ÿçš„æ¨¡å‹èµ·ä¸åˆ°è¾ƒå¥½çš„æ•ˆæœã€‚æ‰€ä»¥è¿™æ¬¡å®éªŒæ¥çœ‹ï¼Œæå‡é¢„æµ‹ç»“æœæ¯”è¾ƒæœ‰æ•ˆçš„é€”å¾„æ˜¯æ”¹é€ æ•°æ®</p>

<p>â€‹	     æœ¬èº«è€Œä¸æ˜¯å»ä¿®æ”¹ç®—æ³•æ¨¡å‹ï¼Œæ¯”å¦‚åœ¨æ·»åŠ äº†å¤´è¡”ç‰¹å¾åï¼Œæ¨¡å‹çš„æ•ˆæœæœ‰äº†æ˜æ˜¾çš„å˜åŒ–ã€‚ç”±äºè¿™æ¬¡å®éªŒçš„</p>

<p>â€‹	     æ•°æ®é›†è‡ªèº«é™åˆ¶ï¼Œå¸¸è§„ç®—æ³•çš„è¡¨ç°éƒ½ä¸ä¼šå¤ªé«˜ï¼Œè¦ä½¿ç®—æ³•çš„æ­£ç¡®ç‡è¾¾åˆ°ä¸€ä¸ªæ¯”è¾ƒé«˜çš„å€¼ï¼Œå°±éœ€è¦å¯¹æ•°æ®é›†</p>

<p>â€‹             è¿›è¡Œæ”¹é€ ï¼Œæ”¹é€ åçš„æ•°æ®é›†å› ç´ è¶Šå¤šï¼Œè¶Šç¬¦åˆå®é™…æƒ…å†µï¼Œç®—æ³•çš„æ•ˆæœå°±ä¼šè¶Šå¥½ï¼Œè¿™ä¸€ç‚¹åœ¨onehot.pyå®ç°</p>

<p>â€‹	      çš„ç®—æ³•æ•ˆæœæ›´å¥½ä¸Šå¯ä»¥ä½“ç°å‡ºæ¥ã€‚</p>

<h4 id="62-éš¾ç‚¹ä¸åˆ›æ–°ç‚¹">6.2	éš¾ç‚¹ä¸åˆ›æ–°ç‚¹</h4>

<p>â€‹		è¿™æ¬¡å®éªŒä¸­ï¼Œä¸»è¦é¢å¯¹çš„éš¾ç‚¹æ˜¯ï¼š</p>

<ul>
  <li>æ•°æ®é›†ä¸­å¤§é‡çš„ç¼ºå¤±å’Œæ— æ³•ç›´æ¥ç”¨äºè®¡ç®—çš„å±æ€§ã€‚</li>
  <li>
    <p>è§£å†³æ¨¡å‹äº§ç”Ÿçš„è¿‡æ‹Ÿåˆé—®é¢˜</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  ä¸»è¦å°è¯•è¿‡çš„åˆ›æ–°æœ‰:
</code></pre></div>    </div>
  </li>
  <li>
    <p>ç”¨éšæœºæ£®æ—ç®—æ³•è¡¥å…¨ageçš„ç¼ºå¤±å€¼ï¼Œå› ä¸ºAgeå¯¹ç»“æœçš„å½±å“éå¸¸æ˜¾è‘—ã€‚</p>
  </li>
  <li>
    <p>æŠŠæå–å‡ºæ¥çš„å¤´è¡”åˆ©ç”¨å“ˆå¸Œç®—æ³•æ˜ å°„åˆ°100ä»¥å†…çš„æ•´æ•°å€¼ï¼Œä½†æ˜¯å°è¯•è¿‡åå‘ç°è¿™ç§åšæ³•æ•ˆæœ</p>

    <p>æ²¡æœ‰æŠŠä¹˜å®¢åˆ†ä¸ºè´µå®¾å’Œæ™®é€šä¹˜å®¢æ•ˆæœå¥½ã€‚</p>
  </li>
  <li>æŠŠç±»åˆ«ç›¸å…³çš„å±æ€§æ˜ å°„æˆone-hot-arrayã€‚</li>
</ul>
:ET